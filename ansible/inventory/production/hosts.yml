# SPDX-License-Identifier: Apache-2.0
# Production inventory for TACACS+ servers
---
all:
  children:
    tacacs_servers:
      children:
        # Group locations by region for staged rollouts
        region_northeast:
          hosts:
            tacacs-nyc01-01:
              ansible_host: 10.1.1.11
              tacacs_location: NYC01
            tacacs-nyc01-02:
              ansible_host: 10.1.1.12
              tacacs_location: NYC01
            tacacs-bos01-01:
              ansible_host: 10.1.2.11
              tacacs_location: BOS01

        region_west:
          hosts:
            tacacs-lax01-01:
              ansible_host: 10.2.1.11
              tacacs_location: LAX01
            tacacs-lax01-02:
              ansible_host: 10.2.1.12
              tacacs_location: LAX01
            tacacs-sfo01-01:
              ansible_host: 10.2.2.11
              tacacs_location: SFO01

        region_central:
          hosts:
            tacacs-chi01-01:
              ansible_host: 10.3.1.11
              tacacs_location: CHI01
            tacacs-chi01-02:
              ansible_host: 10.3.1.12
              tacacs_location: CHI01

    # HAProxy load balancers (one per location or centralized)
    haproxy:
      children:
        haproxy_northeast:
          hosts:
            haproxy-nyc01:
              ansible_host: 10.1.1.10
              tacacs_ha_backends:
                - name: tacacs01
                  address: 10.1.1.11
                  weight: 100
                - name: tacacs02
                  address: 10.1.1.12
                  weight: 100
            haproxy-bos01:
              ansible_host: 10.1.2.10
              tacacs_ha_backends:
                - name: tacacs01
                  address: 10.1.2.11
                  weight: 100

        haproxy_west:
          hosts:
            haproxy-lax01:
              ansible_host: 10.2.1.10
              tacacs_ha_backends:
                - name: tacacs01
                  address: 10.2.1.11
                  weight: 100
                - name: tacacs02
                  address: 10.2.1.12
                  weight: 100
            haproxy-sfo01:
              ansible_host: 10.2.2.10
              tacacs_ha_backends:
                - name: tacacs01
                  address: 10.2.2.11
                  weight: 100

        haproxy_central:
          hosts:
            haproxy-chi01:
              ansible_host: 10.3.1.10
              tacacs_ha_backends:
                - name: tacacs01
                  address: 10.3.1.11
                  weight: 100
                - name: tacacs02
                  address: 10.3.1.12
                  weight: 100

    # PostgreSQL HA cluster for policy-ingest service (central site)
    # etcd cluster for Patroni distributed consensus
    etcd:
      hosts:
        etcd1:
          ansible_host: 10.0.0.11
        etcd2:
          ansible_host: 10.0.0.12
        etcd3:
          ansible_host: 10.0.0.13

    # Patroni-managed PostgreSQL cluster
    patroni:
      hosts:
        pg1:
          ansible_host: 10.0.0.21
        pg2:
          ansible_host: 10.0.0.22
        pg3:
          ansible_host: 10.0.0.23

    # PgBouncer connection pooler (can be co-located or separate)
    pgbouncer:
      hosts:
        pgbouncer1:
          ansible_host: 10.0.0.31
          patroni_leader_host: 10.0.0.21

    # BGP Anycast - TACACS+ servers with FRR for geographic distribution
    # All servers advertise the same anycast VIP via BGP
    tacacs_anycast:
      children:
        # Reference existing TACACS servers
        tacacs_servers:
      vars:
        # Per-location BGP neighbors should be set in host_vars
        # Example for NYC01:
        # frr_bgp_neighbors:
        #   - address: 10.1.1.1
        #     remote_asn: 65100
        #     description: "NYC01-Core-1"
        # frr_bgp_community_location: "65000:1001"
