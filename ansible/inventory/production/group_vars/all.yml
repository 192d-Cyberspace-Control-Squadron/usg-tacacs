# SPDX-License-Identifier: AGPL-3.0-only
# Global variables for all TACACS+ servers
---
# Ansible connection settings
ansible_user: ansible
ansible_become: true
ansible_python_interpreter: /usr/bin/python3

# TACACS+ common settings
tacacs_version: "0.76.0"
tacacs_binary_url: "https://artifacts.example.com/tacacs-rs/{{ tacacs_version }}/tacacs-server"
tacacs_binary_checksum: ""  # Set per release

# Network settings
tacacs_listen_address: "0.0.0.0"
tacacs_legacy_port: 49
tacacs_tls_port: 300
tacacs_http_port: 8080

# TLS settings
tacacs_tls_enabled: true

# LDAP settings (override per environment)
tacacs_ldap_enabled: true
tacacs_ldap_url: "ldaps://ldap.example.com:636"
tacacs_ldap_search_base: "dc=example,dc=com"
tacacs_ldap_username_attr: "sAMAccountName"
tacacs_ldap_group_attr: "memberOf"
tacacs_ldap_timeout_ms: 5000

# Logging
tacacs_log_format: "json"
tacacs_log_level: "info"

# OpenTelemetry
tacacs_otel_enabled: true
tacacs_otel_endpoint: "http://jaeger.monitoring.svc:4317"
tacacs_otel_service_name: "tacacs-server"

# Policy defaults
tacacs_default_allow: false

# Security settings
tacacs_ascii_attempt_limit: 5
tacacs_ascii_user_attempt_limit: 3
tacacs_ascii_pass_attempt_limit: 5
tacacs_ascii_lockout_limit: 10

# HA defaults
tacacs_ha_preempt: true
tacacs_ha_advert_int: 1
