# TACACS+ server secrets policy
# Managed by Ansible - do not edit manually

# Read global TACACS secrets
path "{{ openbao_secret_path_prefix }}/*" {
  capabilities = ["read"]
}

# List secrets metadata
path "secret/metadata/tacacs/*" {
  capabilities = ["list", "read"]
}

{% if openbao_pki_enabled %}
# PKI certificate issuance
path "{{ openbao_pki_mount }}/issue/{{ openbao_pki_role }}" {
  capabilities = ["create", "update"]
}

# Read CA certificate
path "{{ openbao_pki_mount }}/cert/ca" {
  capabilities = ["read"]
}
{% endif %}
