# SPDX-License-Identifier: Apache-2.0
# tacacs_server - Default variables
---
# Version and installation
tacacs_version: "latest"
tacacs_binary_url: ""  # URL to download binary, or leave empty for local copy
tacacs_binary_checksum: ""  # SHA256 checksum of binary

# Location identifier
tacacs_location: "{{ inventory_hostname | regex_replace('^tacacs-', '') | upper }}"

# Network configuration
tacacs_listen_address: "0.0.0.0"
tacacs_legacy_port: 49
tacacs_tls_port: 300
tacacs_http_address: "0.0.0.0"
tacacs_http_port: 8080

# TLS configuration
tacacs_tls_enabled: true
tacacs_tls_cert_file: "{{ tacacs_config_dir }}/certs/server.crt"
tacacs_tls_key_file: "{{ tacacs_config_dir }}/certs/server.key"
tacacs_tls_ca_file: "{{ tacacs_config_dir }}/certs/ca.crt"
tacacs_tls_extra_roots: []

# Shared secret (should be overridden via vault or encrypted vars)
tacacs_shared_secret: "CHANGE_ME_IN_PRODUCTION"

# LDAP configuration (optional)
tacacs_ldap_enabled: false
tacacs_ldap_url: "ldaps://ldap.example.com:636"
tacacs_ldap_bind_dn: ""
tacacs_ldap_bind_password: ""
tacacs_ldap_search_base: ""
tacacs_ldap_username_attr: "sAMAccountName"
tacacs_ldap_group_attr: "memberOf"
tacacs_ldap_required_groups: []
tacacs_ldap_timeout_ms: 5000

# Policy configuration
tacacs_policy_file: "{{ tacacs_config_dir }}/policy.json"
tacacs_default_allow: false

# ASCII authentication settings
tacacs_ascii_attempt_limit: 5
tacacs_ascii_user_attempt_limit: 3
tacacs_ascii_pass_attempt_limit: 5
tacacs_ascii_backoff_ms: 100
tacacs_ascii_backoff_max_ms: 5000
tacacs_ascii_lockout_limit: 0

# Logging configuration
tacacs_log_format: "json"
tacacs_log_level: "info"

# OpenTelemetry (optional)
tacacs_otel_enabled: false
tacacs_otel_endpoint: ""
tacacs_otel_service_name: "tacacs-server"

# Graceful shutdown
tacacs_drain_timeout_seconds: 30

# systemd configuration
tacacs_systemd_memory_max: "1G"
tacacs_systemd_cpu_quota: "200%"

# Static credentials (for testing; use LDAP or vault in production)
tacacs_static_users: {}
# tacacs_static_users:
#   admin:
#     password: "secret123"
#     password_type: "plain"  # or "argon2"

# Health check validation
tacacs_validate_health: true
tacacs_health_check_retries: 5
tacacs_health_check_delay: 2
