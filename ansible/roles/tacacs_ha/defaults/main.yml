# SPDX-License-Identifier: Apache-2.0
# tacacs_ha - Default variables for HAProxy-based HA configuration
---
# HAProxy general configuration
tacacs_ha_haproxy_enabled: true
tacacs_ha_haproxy_user: haproxy
tacacs_ha_haproxy_group: haproxy

# Frontend bindings
tacacs_ha_bind_address: "*"
tacacs_ha_legacy_port: 49      # TACACS+ legacy port
tacacs_ha_tls_port: 300        # TACACS+ TLS port
tacacs_ha_http_port: 8080      # HTTP API port (for metrics/health proxying)

# Stats interface
tacacs_ha_stats_enabled: true
tacacs_ha_stats_port: 8404
tacacs_ha_stats_uri: /stats
tacacs_ha_stats_user: admin
tacacs_ha_stats_password: "CHANGE_ME"
tacacs_ha_stats_refresh: 10s

# Health check configuration
tacacs_ha_health_check_enabled: true
tacacs_ha_health_check_uri: /ready
tacacs_ha_health_check_port: 8080
tacacs_ha_health_check_interval: 2000   # ms
tacacs_ha_health_check_timeout: 1000    # ms
tacacs_ha_health_check_rise: 2          # checks to mark healthy
tacacs_ha_health_check_fall: 3          # checks to mark unhealthy

# Load balancing algorithm
# Options: roundrobin, leastconn, source (sticky by client IP)
tacacs_ha_balance_algorithm: roundrobin

# Connection settings
tacacs_ha_timeout_connect: 5s
tacacs_ha_timeout_client: 60s
tacacs_ha_timeout_server: 60s
tacacs_ha_timeout_check: 5s

# Connection limits
tacacs_ha_maxconn_global: 4096
tacacs_ha_maxconn_frontend: 2048
tacacs_ha_maxconn_server: 256

# Backend servers (required)
tacacs_ha_backends: []
# Example:
# tacacs_ha_backends:
#   - name: tacacs01
#     address: 10.0.0.11
#     port: 49           # Legacy port (optional, default 49)
#     tls_port: 300      # TLS port (optional, default 300)
#     http_port: 8080    # HTTP port (optional, default 8080)
#     weight: 100        # Server weight (optional, default 100)
#     backup: false      # Backup server (optional, default false)
#   - name: tacacs02
#     address: 10.0.0.12
#     backup: true       # Only used when primary servers are down

# Stick tables for session persistence (optional)
tacacs_ha_stick_table_enabled: false
tacacs_ha_stick_table_size: 100k
tacacs_ha_stick_table_expire: 30m

# Logging
tacacs_ha_log_format: "tcplog"  # tcplog or httplog
tacacs_ha_log_facility: local0
tacacs_ha_log_level: info

# Firewall configuration
tacacs_ha_configure_firewall: true

# Graceful reload
tacacs_ha_reload_timeout: 30s
