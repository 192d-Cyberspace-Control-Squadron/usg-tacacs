# SOPS configuration for TACACS+ secrets
# Managed by Ansible - do not edit manually

creation_rules:
{% if sops_encryption_method == "age" and sops_age_recipient is defined %}
  - path_regex: \.enc\.ya?ml$
    encrypted_regex: "{{ sops_encryption_regex }}"
    age: {{ sops_age_recipient }}
{% elif sops_encryption_method == "aws_kms" and sops_kms_arn is defined %}
  - path_regex: \.enc\.ya?ml$
    encrypted_regex: "{{ sops_encryption_regex }}"
    kms: {{ sops_kms_arn }}
{% endif %}

  # Default rule for unmatched files
  - path_regex: .*
    encrypted_regex: "{{ sops_encryption_regex }}"
{% if sops_encryption_method == "age" and sops_age_recipient is defined %}
    age: {{ sops_age_recipient }}
{% elif sops_encryption_method == "aws_kms" and sops_kms_arn is defined %}
    kms: {{ sops_kms_arn }}
{% endif %}
