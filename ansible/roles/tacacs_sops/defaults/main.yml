---
# SOPS (Secrets OPerationS) integration defaults

# SOPS version to install
sops_version: "3.9.0"

# SOPS binary download URL (auto-detected based on architecture)
sops_binary_url: "https://github.com/getsops/sops/releases/download/v{{ sops_version }}/sops-v{{ sops_version }}.linux.{{ sops_arch }}"

# Architecture mapping
sops_arch: "{{ 'arm64' if ansible_architecture == 'aarch64' else 'amd64' }}"

# Where to install SOPS binary
sops_install_path: "/usr/local/bin/sops"

# Encryption method: "age" or "aws_kms"
sops_encryption_method: "age"

# Age key file path (for age encryption)
sops_age_key_file: "/etc/tacacs/sops-age-key.txt"

# AWS KMS ARN (for AWS KMS encryption)
# sops_kms_arn: "arn:aws:kms:us-east-1:123456789:key/abc-123"

# Regex pattern for fields to encrypt
sops_encryption_regex: "^(shared_secret|ldap_bind_password|.*_password|.*_secret)$"

# Path to .sops.yaml configuration
sops_config_path: "/etc/tacacs/.sops.yaml"

# Age public key for encryption (recipient)
# sops_age_recipient: "age1..."

# TACACS user/group
tacacs_user: tacacs
tacacs_group: tacacs
